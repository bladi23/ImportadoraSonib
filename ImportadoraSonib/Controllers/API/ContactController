using ImportadoraSonib.Data;
using ImportadoraSonib.DTOs;
using Microsoft.AspNetCore.Mvc;

namespace ImportadoraSonib.Controllers.Api;

[ApiController]
[Route("api/[controller]")]
public class ContactController : ControllerBase
{
    private readonly ApplicationDbContext _db;
    public ContactController(ApplicationDbContext db) => _db = db;

    [HttpPost]
    public async Task<IActionResult> Post([FromBody] ContactDto dto)
    {
        var msg = new Domain.Entities.ContactMessage { Name = dto.Name, Email = dto.Email, Message = dto.Message };
        _db.ContactMessages.Add(msg);
        await _db.SaveChangesAsync();
        return Created($"/api/contact/{msg.Id}", new { ok = true, id = msg.Id });
    }
}
